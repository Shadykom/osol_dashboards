/* Comprehensive RTL Fix - Unified Solution */

/* 1. Global RTL Setup */
html[dir="rtl"],
html[lang="ar"],
body[dir="rtl"] {
  direction: rtl !important;
  text-align: right !important;
}

/* Global LTR Setup */
html[dir="ltr"],
html[lang="en"],
body[dir="ltr"] {
  direction: ltr !important;
  text-align: left !important;
}

/* 2. Fix Main Layout Container */
[dir="rtl"] #root {
  direction: rtl !important;
}

[dir="ltr"] #root {
  direction: ltr !important;
}

/* Critical: Fix the main flex container */
[dir="rtl"] .flex.h-screen.overflow-hidden {
  flex-direction: row-reverse !important;
}

[dir="ltr"] .flex.h-screen.overflow-hidden {
  flex-direction: row !important;
}

/* 3. Sidebar Positioning */
[dir="rtl"] .sidebar,
[dir="rtl"] aside {
  order: 2 !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
  /* Ensure visibility */
  opacity: 1 !important;
  visibility: visible !important;
  transform: none !important;
  z-index: 40;
}

[dir="ltr"] .sidebar,
[dir="ltr"] aside {
  order: 1 !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
  opacity: 1 !important;
  visibility: visible !important;
  transform: none !important;
  z-index: 40;
}

/* 4. Main Content Area */
[dir="rtl"] main,
[dir="rtl"] .flex-1.flex.flex-col.min-w-0 {
  order: 1 !important;
}

[dir="ltr"] main,
[dir="ltr"] .flex-1.flex.flex-col.min-w-0 {
  order: 2 !important;
}

/* 5. Fix All Flex Containers */
[dir="rtl"] .flex:not(.flex-col):not(.flex-column):not([class*="flex-col"]) {
  flex-direction: row-reverse !important;
}

[dir="ltr"] .flex:not(.flex-col):not(.flex-column):not([class*="flex-col"]) {
  flex-direction: row !important;
}

/* 6. Margin Utilities Override */
[dir="rtl"] [class*="ml-"]:not([class*="ml-0"]) {
  margin-left: 0 !important;
}

[dir="rtl"] [class*="mr-"]:not([class*="mr-0"]) {
  margin-right: 0 !important;
}

/* Specific margin fixes for RTL */
[dir="rtl"] .ml-1 { margin-right: 0.25rem !important; margin-left: 0 !important; }
[dir="rtl"] .ml-2 { margin-right: 0.5rem !important; margin-left: 0 !important; }
[dir="rtl"] .ml-3 { margin-right: 0.75rem !important; margin-left: 0 !important; }
[dir="rtl"] .ml-4 { margin-right: 1rem !important; margin-left: 0 !important; }
[dir="rtl"] .ml-auto { margin-right: auto !important; margin-left: 0 !important; }

[dir="rtl"] .mr-1 { margin-left: 0.25rem !important; margin-right: 0 !important; }
[dir="rtl"] .mr-2 { margin-left: 0.5rem !important; margin-right: 0 !important; }
[dir="rtl"] .mr-3 { margin-left: 0.75rem !important; margin-right: 0 !important; }
[dir="rtl"] .mr-4 { margin-left: 1rem !important; margin-right: 0 !important; }
[dir="rtl"] .mr-auto { margin-left: auto !important; margin-right: 0 !important; }

/* 7. Padding Utilities Override */
[dir="rtl"] [class*="pl-"]:not([class*="pl-0"]) {
  padding-left: 0 !important;
}

[dir="rtl"] [class*="pr-"]:not([class*="pr-0"]) {
  padding-right: 0 !important;
}

[dir="rtl"] .pl-1 { padding-right: 0.25rem !important; padding-left: 0 !important; }
[dir="rtl"] .pl-2 { padding-right: 0.5rem !important; padding-left: 0 !important; }
[dir="rtl"] .pl-3 { padding-right: 0.75rem !important; padding-left: 0 !important; }
[dir="rtl"] .pl-4 { padding-right: 1rem !important; padding-left: 0 !important; }
[dir="rtl"] .pl-6 { padding-right: 1.5rem !important; padding-left: 0 !important; }
[dir="rtl"] .pl-8 { padding-right: 2rem !important; padding-left: 0 !important; }

[dir="rtl"] .pr-1 { padding-left: 0.25rem !important; padding-right: 0 !important; }
[dir="rtl"] .pr-2 { padding-left: 0.5rem !important; padding-right: 0 !important; }
[dir="rtl"] .pr-3 { padding-left: 0.75rem !important; padding-right: 0 !important; }
[dir="rtl"] .pr-4 { padding-left: 1rem !important; padding-right: 0 !important; }
[dir="rtl"] .pr-6 { padding-left: 1.5rem !important; padding-right: 0 !important; }
[dir="rtl"] .pr-8 { padding-left: 2rem !important; padding-right: 0 !important; }

/* 8. Space Utilities */
[dir="rtl"] [class*="space-x-"] > :not([hidden]) ~ :not([hidden]) {
  margin-left: 0 !important;
}

[dir="rtl"] .space-x-1 > :not([hidden]) ~ :not([hidden]) { margin-right: 0.25rem !important; }
[dir="rtl"] .space-x-2 > :not([hidden]) ~ :not([hidden]) { margin-right: 0.5rem !important; }
[dir="rtl"] .space-x-3 > :not([hidden]) ~ :not([hidden]) { margin-right: 0.75rem !important; }
[dir="rtl"] .space-x-4 > :not([hidden]) ~ :not([hidden]) { margin-right: 1rem !important; }

/* 9. Border Utilities */
[dir="rtl"] .border-l {
  border-left-width: 0 !important;
  border-right-width: 1px !important;
}

[dir="rtl"] .border-r {
  border-right-width: 0 !important;
  border-left-width: 1px !important;
}

[dir="rtl"] .border-l-4 {
  border-left-width: 0 !important;
  border-right-width: 4px !important;
}

/* 10. Position Utilities */
[dir="rtl"] .left-0 { left: auto !important; right: 0 !important; }
[dir="rtl"] .right-0 { right: auto !important; left: 0 !important; }
[dir="rtl"] .left-4 { left: auto !important; right: 1rem !important; }
[dir="rtl"] .right-4 { right: auto !important; left: 1rem !important; }

/* 11. Text Alignment */
[dir="rtl"] .text-left { text-align: right !important; }
[dir="rtl"] .text-right { text-align: left !important; }

/* 12. Icon Flipping */
[dir="rtl"] .lucide-chevron-right,
[dir="rtl"] .lucide-chevron-left,
[dir="rtl"] .lucide-arrow-right,
[dir="rtl"] .lucide-arrow-left {
  transform: scaleX(-1) !important;
}

/* 13. Tables */
[dir="rtl"] table {
  direction: rtl !important;
  text-align: right !important;
}

[dir="rtl"] th,
[dir="rtl"] td {
  text-align: right !important;
}

/* 14. Forms */
[dir="rtl"] input,
[dir="rtl"] textarea,
[dir="rtl"] select {
  text-align: right !important;
  direction: rtl !important;
}

/* 15. Charts - Keep LTR */
[dir="rtl"] .recharts-wrapper {
  direction: ltr !important;
}

/* 16. Specific Component Fixes */
[dir="rtl"] .card-header,
[dir="rtl"] .widget-header {
  flex-direction: row-reverse !important;
}

/* 17. Navigation */
[dir="rtl"] nav ul,
[dir="rtl"] nav .flex {
  flex-direction: row-reverse !important;
}

/* 18. Dropdowns and Popovers */
[dir="rtl"] [data-radix-popper-content-wrapper] {
  text-align: right !important;
}

/* 19. Modals and Sheets */
[dir="rtl"] [role="dialog"] {
  text-align: right !important;
}

[dir="rtl"] .dialog-close {
  right: auto !important;
  left: 1rem !important;
}

/* 20. Arabic Font Priority */
[dir="rtl"] * {
  font-family: 'Noto Sans Arabic', 'Tajawal', 'Cairo', system-ui, sans-serif !important;
}

/* 21. High Priority Overrides */
[dir="rtl"] .flex.h-screen.overflow-hidden.bg-gray-50,
[dir="rtl"] .flex.h-screen.overflow-hidden.dark\:bg-gray-950 {
  flex-direction: row-reverse !important;
}

/* 22. Ensure Order Properties Work */
[dir="rtl"] .order-1 { order: 1 !important; }
[dir="rtl"] .order-2 { order: 2 !important; }

/* 23. Fix Layout Component Specific Classes */
[dir="rtl"] .rtl {
  direction: rtl !important;
}

[dir="rtl"] .flex-row-reverse {
  flex-direction: row !important;
}

/* 24. Sheet Component RTL */
[dir="rtl"] [data-sheet-side="left"] {
  right: 0 !important;
  left: auto !important;
}

[dir="rtl"] [data-sheet-side="right"] {
  left: 0 !important;
  right: auto !important;
}

/* 25. Ensure Sidebar Gradient Works */
[dir="rtl"] .sidebar.bg-gradient-to-b {
  background-image: linear-gradient(to bottom, var(--tw-gradient-stops)) !important;
}

/* Fix complex gradients that might cause rendering issues in RTL */
[dir="rtl"] .sidebar {
  /* Simplify gradient for better RTL rendering */
  background: linear-gradient(to bottom, 
    rgb(249 250 251), 
    rgb(255 255 255), 
    rgb(249 250 251)) !important;
}

[dir="rtl"] .dark .sidebar {
  background: linear-gradient(to bottom, 
    rgb(17 24 39), 
    rgb(3 7 18), 
    rgb(17 24 39)) !important;
}

/* 26. Fix any Transform Issues */
[dir="rtl"] .sidebar {
  transform: none !important;
  -webkit-transform: none !important;
}

/* 27. Scrollbar Position */
[dir="rtl"] {
  scrollbar-gutter: stable;
}

[dir="rtl"]::-webkit-scrollbar {
  position: absolute;
}

/* 28. Z-Index Hierarchy */
[dir="rtl"] .sidebar { z-index: 40 !important; }
[dir="rtl"] header { z-index: 30 !important; }
[dir="rtl"] main { z-index: 10 !important; }

/* 29. Ensure Visibility */
[dir="rtl"] .sidebar,
[dir="rtl"] .sidebar * {
  opacity: 1 !important;
  visibility: visible !important;
}

/* 30. Final Override for Main Container */
body[dir="rtl"] #root > div:first-child {
  flex-direction: row-reverse !important;
}

/* 31. Fix Backdrop Blur Issues in RTL */
[dir="rtl"] .backdrop-blur-md,
[dir="rtl"] .backdrop-blur-lg,
[dir="rtl"] .backdrop-blur-xl {
  -webkit-backdrop-filter: blur(12px) !important;
  backdrop-filter: blur(12px) !important;
}

/* 32. Fix Shadow Issues in RTL */
[dir="rtl"] .shadow-2xl {
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.1) !important;
}

/* 33. Disable Complex Effects That Might Cause Issues */
[dir="rtl"] .blur-xl,
[dir="rtl"] .blur-lg {
  filter: none !important;
  -webkit-filter: none !important;
}

/* 34. Force Hardware Acceleration */
[dir="rtl"] .sidebar {
  will-change: transform;
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
}

/* 35. Additional Sidebar Specific Fixes */
[dir="rtl"] .sidebar > * {
  position: relative;
  z-index: 1;
}

/* 36. Fix Overflow Issues */
[dir="rtl"] .sidebar {
  overflow-x: hidden !important;
  overflow-y: auto !important;
}

/* 37. Ensure All Text is Visible */
[dir="rtl"] .sidebar,
[dir="rtl"] .sidebar * {
  color: inherit !important;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* 38. Fix Any Position Absolute Elements */
[dir="rtl"] .sidebar .absolute {
  position: absolute !important;
  inset: auto !important;
}

/* 39. Ensure Proper Border Rendering */
[dir="rtl"] .sidebar {
  border-left: 1px solid rgb(229 231 235) !important;
  border-right: 0 !important;
}

[dir="rtl"] .dark .sidebar {
  border-left: 1px solid rgb(31 41 55) !important;
}

/* 40. Final Layout Override */
[dir="rtl"] body {
  overflow-x: hidden !important;
}